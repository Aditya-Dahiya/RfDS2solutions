---
title: "Chapter 10"
subtitle: "Layers"
author: "Aditya Dahiya"
date: 2023-08-16
execute: 
  warning: false
  error: false
filters:
  - social-share
share:
  permalink: "https://aditya-dahiya.github.io/RfDS2solutions/Chapter10.html"
  description: "Solutions: R for Data Science (2e)"
  twitter: true
  facebook: true
  linkedin: true
  email: true
editor_options: 
  chunk_output_type: console
bibliography: references.bib
---

# Important Points:

> "The greatest value of a picture is when it forces us to notice what we never expected to see." --- *John Tukey*

-   `ggplot2` will use maximum 6 shapes at a time. The 7th shape is treated as a missing value.

-   Using `alpha` aesthetic for a discrete variable is not advised.

-   The shapes used in `ggplot2` are as follows[@ggplot2] :\--

    [![Shapes available to use in ggplot2.](https://ggplot2.tidyverse.org/articles/ggplot2-specs_files/figure-html/unnamed-chunk-7-1.png){fig-align="left" width="355"}](https://ggplot2.tidyverse.org/articles/ggplot2-specs_files/figure-html/unnamed-chunk-7-1.png)

-   The best place to explore `ggplot2` extensions and graphs is the [ggplot2 extensions gallery](https://exts.ggplot2.tidyverse.org/gallery/ "Registered extensions available to explore for ggplot2").

-   Best place to search for and understand the `geoms` within `ggplot2` is ggplot2 [Function Reference](https://ggplot2.tidyverse.org/reference/ "ggplot2 Official Function Reference Guide").

```{r}
#| label: setup
#| warning: false
#| error: false

library(tidyverse)
data("mpg")

```

# **10.2.1 Exercises**

### Question 1

**Create a scatterplot of `hwy` vs.Â `displ` where the points are pink filled in triangles.**

The scatter-plot is displayed in @fig-q1-ex1 .

```{r}
#| label: fig-q1-ex1
#| fig-cap: "Question 1: Scatterplot of hwy vs. displ"
#| message: false
#| error: false
#| warning: false

mpg |>
  ggplot(aes(x = hwy, y = displ)) +
  geom_point(shape = 24, fill = "pink") +
  theme_bw()
```

### Question 2

**Why did the following code not result in a plot with blue points?**

```         
ggplot(mpg) +    
  geom_point(aes(x = displ, y = hwy, color = "blue"))
```

The mistakes in this code produces a wrong plot as shown in @fig-q2-ex2-wrong .

```{r}
#| label: fig-q2-ex2-wrong
#| fig-cap: "The wrong plot produced by the faulty code"
ggplot(mpg) +    
  geom_point(aes(x = displ, y = hwy, color = "blue"))
```

The code will not result in "blue" points because the argument `color = "blue"` is within the aesthetics brackets, i.e., `aes()`. This is because this treats color as an aesthetic to be mapped to a variable. And, `ggplot2` starts looking for a variable called `blue` which does not exist. Accordingly, it produces a scatter plot which shows legend of color, with a variable called "blue".

The corrected code and results are displayed below in @fig-q2-ex2 .

```{r}
#| label: fig-q2-ex2
#| fig-cap: "Corrected code produces blue points in the scatterplot"

mpg |>
  ggplot() +
  geom_point(aes(x = displ, y = hwy), 
             color = "blue") +
  theme_bw()
```

### Question 3

**What does the `stroke` aesthetic do? What shapes does it work with? (Hint: use [`?geom_point`](https://ggplot2.tidyverse.org/reference/geom_point.html))**

The `stroke` aesthetic controls the width of the border of the points in the `geom_point` . It works with all the shapes, as I tried, but it would work best with shapes 21, 22, 23 and 24 as shown below :\-\--

[![Shapes available to use in ggplot2.](https://ggplot2.tidyverse.org/articles/ggplot2-specs_files/figure-html/unnamed-chunk-7-1.png){alt="Shapes available to use in ggplot2." fig-align="left" width="355"}](https://ggplot2.tidyverse.org/articles/ggplot2-specs_files/figure-html/unnamed-chunk-7-1.png)

```{r}
#| label: fig-q3-ex2
#| fig-cap: "Use of stroke aesthetic"

mpg |>
  ggplot() +
  geom_point(aes(x = displ, 
                 y = hwy,
                 stroke = displ/2),
             shape = 22) +
  theme_bw()
```

### Question 4

**What happens if you map an aesthetic to something other than a variable name, like `aes(color = displ < 5)`? Note, you'll also need to specify x and y.**

In this case, I expect that the aesthetic `color` will be mapped to a logical variable, that can have two values, either `TRUE` (mapped to one colour) or `FALSE` (mapped to a second colour). Thus, the logical expression gets treated like a factor with two levels. The legend to the plot shows the two levels of that factor. For example:\-\--

```{r}
#| label: fig-q4-ex2
#| fig-cap: "Use of a logical expression in place of a variable in an aesthetic"

mpg |>
  ggplot(aes(x = displ, 
             y = hwy,
             color = displ < 5)) +
  geom_point() +
  theme_bw()

```

# 10.3.1 Exercises

### Question 1

**What geom would you use to draw a line chart? A boxplot? A histogram? An area chart?**

We would use the following geoms:

| S. No. | Chart type | `geom_` to use in `ggplot2` |
|--------|------------|-----------------------------|
| 1      | Line Chart | `geom_line()`               |
| 2      | Boxplot    | `geom_boxplot()`            |
| 3      | Histogram  | `geom_histogram()`          |
| 4      | Area Chart | `geom_area()`               |

: The geoms to use for different graph types

### Question 2

**Earlier in this chapter we used `show.legend` without explaining it:**

``` r
ggplot(mpg, aes(x = displ, y = hwy)) +
  geom_smooth(aes(color = drv), show.legend = FALSE)
```

**What does `show.legend = FALSE` do here? What happens if you remove it? Why do you think we used it earlier?**

The argument `show.legend = TRUE/FALSE` decides whether the legend for colour, shape or size aesthetics should be displayed in the plot or not.

If we remove `show.legend = FALSE` from the code above, by default, `ggplot2` will display the legend if it feels that a visual aesthetic has been mapped to a variable. By default, the position of the legend is on the right hand side of the plot.

I think we used it earlier in the chapter because we were displaying three plots in the same row, side-by-side, and wanted them to be of the same dimensions in the plot area to convey the difference between `group` and `color` aesthetics in mapping. If we had not included `show.legend = FALSE` , the third plot would have been squished due to presence of a legend on the right side. Here, the purpose was not to tell different colours representing `drv` of the cars, but to show difference between `group` and `color` aesthetics in mapping. Hence, we chose to ignore the legend.

```{r}
#| label: q2-ex3

ggplot(mpg, aes(x = displ, y = hwy)) +
  geom_smooth(aes(color = drv), show.legend = FALSE) +
  theme_bw()
```

### Question 3

**What does the `se` argument to `geom_smooth()` do?**

The `se` argument tells `ggplot2` whether to display the confidence interval around the smooth line fitted to the data.

### Question 4

**Recreate the R code necessary to generate the following graphs. Note that wherever a categorical variable is used in the plot, it's `drv`.**

[![Figure shown in Question 5, Exercise 10.3.1, R for Data Science (2e)](docs/ch10-q4-ex3.png){width="413"}](https://r4ds.hadley.nz/layers#exercises)

The R-code is as shown below:\--

```{r}
#| label: q4-ex3
#| layout-ncol: 2
#| layout-nrow: 3

# First Plot
mpg |>
  ggplot(aes(displ, hwy)) +
  geom_point() +
  geom_smooth(se = FALSE, color = "blue")

# Second Plot
mpg |>
  ggplot(aes(displ, hwy)) +
  geom_point() +
  geom_smooth(aes(group = drv), 
              se = FALSE, 
              color = "blue")

# Third Plot
mpg |>
  ggplot(aes(x = displ, 
             y = hwy,
             color = drv)) +
  geom_point() +
  geom_smooth(se = FALSE)

# Fourth Plot
mpg |>
  ggplot(aes(displ, hwy)) +
  geom_point(aes(color = drv)) +
  geom_smooth(se = FALSE, color = "blue")

# Fifth Plot
mpg |>
  ggplot(aes(displ, hwy)) +
  geom_point(aes(color = drv)) +
  geom_smooth(aes(linetype = drv),
              se = FALSE, 
              color = "blue")

# Sixth Plot
mpg |>
  ggplot(aes(x = displ, 
             y = hwy,
             fill = drv)) +
  geom_point(shape = 21,
             color = "white",
             stroke = 1.5)
```
