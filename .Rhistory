median_delay = median(dep_delay, na.rm = TRUE),
numbers = n()
) |>
pivot_longer(cols = -weekday,
names_to = "indicator",
values_to = "val") |>
ggplot(aes(y = weekday, x = val)) +
geom_bar(stat = "identity") +
facet_wrap(~ indicator, scales = "free")
?facet_grid
flights |>
mutate(
sched_dep_time = make_datetime(year, month, day,
sched_dep_time %/% 100,
sched_dep_time %% 100),
weekday = wday(sched_dep_time, label = TRUE, abbr = FALSE)
) |>
group_by(weekday) |>
summarise(
mean_delay = mean(dep_delay, na.rm = TRUE),
median_delay = median(dep_delay, na.rm = TRUE),
numbers = n()
) |>
pivot_longer(cols = -weekday,
names_to = "indicator",
values_to = "val") |>
ggplot(aes(y = weekday, x = val)) +
geom_bar(stat = "identity") +
facet_grid(~ indicator, scales = "free_x") +
theme_minimal()
flights |>
mutate(
sched_dep_time = make_datetime(year, month, day,
sched_dep_time %/% 100,
sched_dep_time %% 100),
weekday = wday(sched_dep_time, label = TRUE, abbr = FALSE)
) |>
group_by(weekday) |>
summarise(
mean_delay = mean(dep_delay, na.rm = TRUE),
median_delay = median(dep_delay, na.rm = TRUE),
numbers = n()
) |>
pivot_longer(cols = -weekday,
names_to = "indicator",
values_to = "val") |>
ggplot(aes(y = weekday, x = val, fill = indicator)) +
geom_bar(stat = "identity") +
facet_grid(~ indicator, scales = "free_x") +
labs(x = NULL, y = NULL) +
theme_minimal() +
theme(legend.position = "none")
?facet_grid
# Sample data
data <- data.frame(
x = rep(1:3, each = 4),
y = rep(1:4, times = 3),
value = rnorm(12)
)
data
# Create a custom labeling function
custom_labeller <- function(variable, value) {
if (variable == "x") {
return(paste("X-axis Label: ", value))
} else if (variable == "y") {
return(paste("Y-axis Label: ", value))
} else {
return(value)
}
}
# Create a ggplot with facet_grid and custom labeling
plot <- ggplot(data, aes(x, y, fill = value)) +
geom_tile() +
facet_grid(. ~ x, labeller = labeller(x = custom_labeller, y = custom_labeller)) +
labs(title = "Custom Facet Labels")
# Print the plot
print(plot)
# Create a ggplot with facet_grid and custom labeling
ggplot(data, aes(x, y, fill = value)) +
geom_tile() +
facet_grid(. ~ x, labeller = labeller(x = custom_labeller, y = custom_labeller)) +
labs(title = "Custom Facet Labels")
?labeller
s
flights |>
mutate(
sched_dep_time = make_datetime(year, month, day,
sched_dep_time %/% 100,
sched_dep_time %% 100),
weekday = wday(sched_dep_time, label = TRUE, abbr = FALSE)
) |>
group_by(weekday) |>
summarise(
mean_delay = mean(dep_delay, na.rm = TRUE),
median_delay = median(dep_delay, na.rm = TRUE),
numbers = n()
) |>
pivot_longer(cols = -weekday,
names_to = "indicator",
values_to = "val") |>
ggplot(aes(y = weekday, x = val, fill = indicator)) +
geom_bar(stat = "identity") +
facet_grid(~ indicator, scales = "free_x") +
labs(x = NULL, y = NULL) +
theme_minimal() +
theme(legend.position = "none")
labels_grid = c("Mean delay (in mins)",
"Median delay (in mins)",
"Number of flights")
flights |>
mutate(
sched_dep_time = make_datetime(year, month, day,
sched_dep_time %/% 100,
sched_dep_time %% 100),
weekday = wday(sched_dep_time, label = TRUE, abbr = FALSE)
) |>
group_by(weekday) |>
summarise(
mean_delay = mean(dep_delay, na.rm = TRUE),
median_delay = median(dep_delay, na.rm = TRUE),
numbers = n()
) |>
pivot_longer(cols = -weekday,
names_to = "indicator",
values_to = "val") |>
ggplot(aes(y = weekday, x = val, fill = indicator)) +
geom_bar(stat = "identity") +
facet_grid(~ indicator, scales = "free_x",
labeller = labeller(indicator = labels_grid)) +
labs(x = NULL, y = NULL) +
theme_minimal() +
theme(legend.position = "none")
labels_grid = c(
mean_delay = "Mean delay (in mins)",
median_delay = "Median delay (in mins)",
numbers = "Number of flights")
flights |>
mutate(
sched_dep_time = make_datetime(year, month, day,
sched_dep_time %/% 100,
sched_dep_time %% 100),
weekday = wday(sched_dep_time, label = TRUE, abbr = FALSE)
) |>
group_by(weekday) |>
summarise(
mean_delay = mean(dep_delay, na.rm = TRUE),
median_delay = median(dep_delay, na.rm = TRUE),
numbers = n()
) |>
pivot_longer(cols = -weekday,
names_to = "indicator",
values_to = "val") |>
ggplot(aes(y = weekday, x = val, fill = indicator)) +
geom_bar(stat = "identity") +
facet_grid(~ indicator, scales = "free_x",
labeller = labeller(indicator = labels_grid)) +
labs(x = NULL, y = NULL) +
theme_minimal() +
theme(legend.position = "none")
flights |>
mutate(
sched_dep_time = make_datetime(year, month, day,
sched_dep_time %/% 100,
sched_dep_time %% 100),
weekday = wday(sched_dep_time, label = TRUE, abbr = FALSE)
) |>
group_by(weekday) |>
summarise(
mean_delay = mean(dep_delay, na.rm = TRUE),
median_delay = median(dep_delay, na.rm = TRUE),
numbers = n()
) |>
pivot_longer(cols = -weekday,
names_to = "indicator",
values_to = "val") |>
ggplot(aes(y = weekday, x = val, fill = indicator)) +
geom_bar(stat = "identity") +
geom_vline(aes(y = 0)) +
facet_grid(~ indicator, scales = "free_x",
labeller = labeller(indicator = labels_grid)) +
labs(x = NULL, y = NULL) +
theme_minimal() +
theme(legend.position = "none")
?geom_vline
flights |>
mutate(
sched_dep_time = make_datetime(year, month, day,
sched_dep_time %/% 100,
sched_dep_time %% 100),
weekday = wday(sched_dep_time, label = TRUE, abbr = FALSE)
) |>
group_by(weekday) |>
summarise(
mean_delay = mean(dep_delay, na.rm = TRUE),
median_delay = median(dep_delay, na.rm = TRUE),
numbers = n()
) |>
pivot_longer(cols = -weekday,
names_to = "indicator",
values_to = "val") |>
ggplot(aes(y = weekday, x = val, fill = indicator)) +
geom_bar(stat = "identity") +
geom_vline(yintercept = 0) +
facet_grid(~ indicator, scales = "free_x",
labeller = labeller(indicator = labels_grid)) +
labs(x = NULL, y = NULL) +
theme_minimal() +
theme(legend.position = "none")
flights |>
mutate(
sched_dep_time = make_datetime(year, month, day,
sched_dep_time %/% 100,
sched_dep_time %% 100),
weekday = wday(sched_dep_time, label = TRUE, abbr = FALSE)
) |>
group_by(weekday) |>
summarise(
mean_delay = mean(dep_delay, na.rm = TRUE),
median_delay = median(dep_delay, na.rm = TRUE),
numbers = n()
) |>
pivot_longer(cols = -weekday,
names_to = "indicator",
values_to = "val") |>
ggplot(aes(y = weekday, x = val, fill = indicator)) +
geom_bar(stat = "identity") +
geom_vline(xintercept = 0) +
facet_grid(~ indicator, scales = "free_x",
labeller = labeller(indicator = labels_grid)) +
labs(x = NULL, y = NULL) +
theme_minimal() +
theme(legend.position = "none")
flights |>
mutate(
dep_time = make_datetime(year, month, day,
dep_time %/% 100,
dep_time %% 100),
weekday = wday(sched_dep_time, label = TRUE, abbr = FALSE)
) |>
group_by(weekday) |>
summarise(
mean_delay = mean(dep_delay, na.rm = TRUE),
median_delay = median(dep_delay, na.rm = TRUE),
numbers = n()
) |>
pivot_longer(cols = -weekday,
names_to = "indicator",
values_to = "val") |>
ggplot(aes(y = weekday, x = val, fill = indicator)) +
geom_bar(stat = "identity") +
geom_vline(xintercept = 0) +
facet_grid(~ indicator, scales = "free_x",
labeller = labeller(indicator = labels_grid)) +
labs(x = NULL, y = NULL) +
theme_minimal() +
theme(legend.position = "none")
flights |>
mutate(
dep_time = make_datetime(year, month, day,
dep_time %/% 100,
dep_time %% 100),
weekday = wday(dep_time, label = TRUE, abbr = FALSE)
) |>
group_by(weekday) |>
summarise(
mean_delay = mean(dep_delay, na.rm = TRUE),
median_delay = median(dep_delay, na.rm = TRUE),
numbers = n()
) |>
pivot_longer(cols = -weekday,
names_to = "indicator",
values_to = "val") |>
ggplot(aes(y = weekday, x = val, fill = indicator)) +
geom_bar(stat = "identity") +
geom_vline(xintercept = 0) +
facet_grid(~ indicator, scales = "free_x",
labeller = labeller(indicator = labels_grid)) +
labs(x = NULL, y = NULL) +
theme_minimal() +
theme(legend.position = "none")
flights |>
mutate(
dep_time = make_datetime(year, month, day,
dep_time %/% 100,
dep_time %% 100),
weekday = wday(dep_time, label = TRUE, abbr = FALSE)
) |>
group_by(weekday) |>
summarise(
mean_delay = mean(dep_delay, na.rm = TRUE),
median_delay = median(dep_delay, na.rm = TRUE),
numbers = n()
) |>
drop_na() |>
pivot_longer(cols = -weekday,
names_to = "indicator",
values_to = "val") |>
ggplot(aes(y = weekday, x = val, fill = indicator)) +
geom_bar(stat = "identity") +
geom_vline(xintercept = 0) +
facet_grid(~ indicator, scales = "free_x",
labeller = labeller(indicator = labels_grid)) +
labs(x = NULL, y = NULL) +
theme_minimal() +
theme(legend.position = "none")
flights |>
mutate(
dep_time = make_datetime(year, month, day,
dep_time %/% 100,
dep_time %% 100),
weekday = wday(dep_time, label = TRUE, abbr = FALSE)
) |>
group_by(weekday) |>
summarise(
mean_delay = mean(dep_delay, na.rm = TRUE),
median_delay = median(dep_delay, na.rm = TRUE),
numbers = n()
) |>
drop_na() |>
pivot_longer(cols = -weekday,
names_to = "indicator",
values_to = "val") |>
ggplot(aes(y = weekday, x = val, fill = indicator)) +
geom_bar(stat = "identity") +
geom_vline(xintercept = 0) +
facet_grid(~ indicator, scales = "free_x",
labeller = labeller(indicator = labels_grid)) +
labs(x = NULL, y = NULL) +
theme_minimal() +
theme(legend.position = "none") +
scale_fill_brewer(palette = "Dark2")
data("diamonds")
hist(diamonds$carat)
flights
f5 = flights |>
select(hour, minute, sched_dep_time, dep_time)
flights |>
select(hour, minute, sched_dep_time, dep_time)
f5 = flights |>
mutate(sched_dep_time = hour + minute/60)
hist(f5$sched_dep_time)
diamonds |>
ggplot(aes(x = carat)) +
geom_histogram(bindwidth = 0.1)
diamonds |>
ggplot(aes(x = carat)) +
geom_histogram(bindwidth = 0.01)
diamonds |>
ggplot(aes(x = carat)) +
geom_histogram(bins = 100)
diamonds |>
ggplot(aes(x = carat)) +
geom_histogram(bins = 1000)
diamonds |>
ggplot(aes(x = carat)) +
geom_histogram(bins = 200)
diamonds |>
ggplot(aes(x = carat)) +
geom_histogram(bins = 500)
diamonds |>
ggplot(aes(x = carat)) +
geom_histogram(bins = 500) +
coord_cartesian(xlim = c(0, 3)) +
theme_minimal()
diamonds |>
ggplot(aes(x = carat)) +
geom_histogram(bins = 500) +
coord_cartesian(xlim = c(0, 3)) +
theme_minimal() +
labs(x = "Carat of Diamond", y = "Number of Diamonds",
title = "Carats of diamonds are mostly in multiples of 0.5",
subtitle = "This suggests observer bias in propensity to round off carat to nearest 0.5") +
scale_x_continuous(breaks = seq(0, 3, 0.5))
diamonds |>
ggplot(aes(x = carat)) +
geom_histogram(bins = 500) +
coord_cartesian(xlim = c(0, 3)) +
theme_minimal() +
labs(x = "Carat of Diamond", y = "Number of Diamonds",
title = "Carats of diamonds are mostly in multiples of 0.5",
subtitle = "This suggests observations recorders' bias in propensity to round off carat to nearest 0.5") +
scale_x_continuous(breaks = seq(0, 3, 0.5))
f5 = flights |>
mutate(sched_dep_time = hour + minute/60)
f5 |>
ggplot(aes(sched_dep_time)) +
geom_histogram(bins = 1000)
f5 |>
ggplot(aes(sched_dep_time)) +
geom_histogram(bins = 1000) +
coord_cartesian(xlim = c(5, 24)) +
theme_minimal() +
labs(x = "Scheduled departure time (in hr)",
y = "Number of Flights",
title = "Scheduled Departure times are geenrally in multiples of 5 minutes",
subtitle = "This suggests propensity to round off scheduled departure time to nearest 5 min") +
scale_x_continuous(breaks = seq(5, 24, 1))
f5 |>
ggplot(aes(sched_dep_time)) +
geom_histogram(bins = 1000) +
coord_cartesian(xlim = c(5, 24)) +
theme_minimal() +
labs(x = "Scheduled departure time (in hr)",
y = "Number of Flights",
title = "Scheduled Departure times are geenrally in multiples of 5, 30 or 60 minutes",
subtitle = "This suggests propensity to round off scheduled departure time to nearest hour, or atleast 5 minutes") +
scale_x_continuous(breaks = seq(5, 24, 1))
#| label: setup
library(tidyverse)
library(nycflights13)
library(lubridate)
data("flights")
library(gt)
library(gtExtras)
flights |>
select(hour, minute, sched_dep_time)
flights |>
mutate(
sdt_20_30 = (minute >= 20 & minute <= 30),
sdt_50_60 = (minute >= 50 & minute <= 60),
sdt_round_times = (sdt_20_30 | sdt_50_60),
was_delayed = (dep_delay < 0),
.keep = "used"
)
f7 = flights |>
mutate(
sdt_20_30 = (minute >= 20 & minute <= 30),
sdt_50_60 = (minute >= 50 & minute <= 60),
sdt_round_times = (sdt_20_30 | sdt_50_60),
was_delayed = (dep_delay < 0),
.keep = "used"
)
f7 |>
group_by(sdt_round_times) |>
summarise(prop_delayed = mean(was_delayed, na.rm = TRUE))
f7 = flights |>
mutate(
sdt_20_30 = (minute >= 20 & minute <= 30),
sdt_50_60 = (minute >= 50 & minute <= 60),
sdt_round_times = (sdt_20_30 | sdt_50_60),
was_delayed = (dep_delay < 0),
nos = n()
.keep = "used"
f7 = flights |>
mutate(
sdt_20_30 = (minute >= 20 & minute <= 30),
sdt_50_60 = (minute >= 50 & minute <= 60),
sdt_round_times = (sdt_20_30 | sdt_50_60),
was_delayed = (dep_delay < 0),
.keep = "used"
)
f7 |>
group_by(sdt_round_times) |>
summarise(prop_delayed = mean(was_delayed, na.rm = TRUE),
n = n())
f7
f7 |>
group_by(sdt_round_times) |>
summarise(prop_delayed = mean(was_delayed, na.rm = TRUE),
n = n())
?prop.test
f8 = f7 |>
group_by(sdt_round_times) |>
summarise(prop_delayed = mean(was_delayed, na.rm = TRUE),
n = n())
f8
f8[1,2]*f8[1,3]
prop.test(
x = c(f8[1,2]*f8[1,3], f8[2,2]*f8[2,3]),
n = c(f8[1,3], f[2,3])
)
prop.test(
x = c(f8[1,2]*f8[1,3], f8[2,2]*f8[2,3]),
n = c(f8[1,3], f8[2,3])
)
f8[1,2]
f8[1,3]
f8[2,2]*f8[2,3]
f8[1,2]*f8[1,3]
f8[2,3]
f8[1,3]
f8[1,2]*f8[1,3]
f8[1,3]
f8[2,2]*f8[2,3]
f8[2,3]
prop.test(
x = c(f8[1,2]*f8[1,3], f8[2,2]*f8[2,3]),
n = c(f8[1,3], f8[2,3])
)
f8[2,2]*f8[2,3]
f8[2,3]
f8[1,3]
prop.test(
x = c(113092, 75098),
n = c(197298, 139478)
)
f7 |>
group_by(sdt_round_times) |>
summarise(prop_delayed = mean(was_delayed, na.rm = TRUE),
n = n())
f8test = prop.test(
x = c(113092, 75098),
n = c(197298, 139478)
)
f8test
f8test$p.value
f8test
f7 |>
group_by(sdt_round_times) |>
summarise(prop_delayed = mean(was_delayed, na.rm = TRUE),
n = n())
f8test
