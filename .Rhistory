labs(x = "Hours per day spent watching TV",
y = "Numbers", title = "Distribution of TV Hours is right skewed")
colnames(gss_cat)
cl_n = colnames(gss_cat)
for (i in cl_n) {
print(levels(gss_cat[,i]))
}
colnames(gss_cat)
print(levels(gss_cat[,"rincome"]))
levels(gss_cat[,"rincome"])
levels(gss_cat$rincome)
for (i in cl_n) {
print(levels(gss_cat$i))
}
nlevels(gss_cat$rincome)
levels(gss_cat$rincome)
colnames(gss_cat)
gss_cat
levels(gss_cat$marital)
levels(gss_cat$marital) |>
str_flatten()
levels(gss_cat$marital) |>
str_flatten_comma()
?str_flatten_comma
levels(gss_cat$marital) |>
str_flatten_comma(last = "and, ")
levels(gss_cat$marital) |>
str_flatten_comma(last = " and, ")
gss_cat
levels(gss_cat$race) |>
str_flatten_comma(last = " and, ")
levels(gss_cat$rincome) |>
str_flatten_comma(last = " and, ")
levels(gss_cat$partyid) |>
str_flatten_comma(last = " and, ")
levels(gss_cat$relig) |>
str_flatten_comma(last = " and, ")
levels(gss_cat$denom) |>
str_flatten_comma(last = " and, ")
#| label: setup
library(tidyverse)
library(ggthemes)
library(gt)
data("gss_cat")
?fct_recode
?fct_relabel
?fct_relevel
?fct_infreq
?fct_lump
gss_cat |>
names()
gss_cat |>
fct_lump_prop(relig, prop = 0.1) |>
ggplot(aes(x = relig)) +
geom_bar()
fct_lump_prop(gss_cat$relig, prop = 0.1) |>
ggplot(aes(x = relig)) +
geom_bar()
gss_cat |>
mutate(
relig = fct_lump_prop(gss_cat$relig, prop = 0.1)
) |>
ggplot(aes(x = relig)) +
geom_bar()
gss_cat |>
mutate(
relig = fct_lump_prop(gss_cat$relig, prop = 0.01)
) |>
ggplot(aes(x = relig)) +
geom_bar()
gss_cat |>
ggplot(aes(x = relig)) +
geom_bar()
gss_cat |>
mutate(
relig = fct_lump_prop(gss_cat$relig, prop = 0.01)
) |>
ggplot(aes(y = relig)) +
geom_bar()
gss_cat |>
mutate(
relig = fct_lump(gss_cat$relig, n = 10)
) |>
ggplot(aes(y = relig)) +
geom_bar()
gss_cat |>
mutate(
relig = fct_lump(gss_cat$relig, n = 2)
) |>
ggplot(aes(y = relig)) +
geom_bar()
gss_cat |>
mutate(
relig = fct_lump(gss_cat$relig, n = Inf)
) |>
ggplot(aes(y = relig)) +
geom_bar()
gss_cat |>
mutate(
relig = fct_lump(gss_cat$relig, n = 5)
) |>
ggplot(aes(y = relig)) +
geom_bar()
gss_cat |>
mutate(
relig = fct_lump(gss_cat$relig, n = 5)
) |>
ggplot(aes(y = fct_reorder(relig))) +
geom_bar()
gss_cat |>
mutate(
relig = fct_lump(gss_cat$relig, n = 5)
) |>
ggplot(aes(y = reorder(relig))) +
geom_bar()
?fct_reorder
?reorder
gss_cat |>
mutate(
relig = fct_lump(gss_cat$relig, n = 5)
) |>
ggplot(aes(y = reorder(relig, -n))) +
geom_bar()
gss_cat |>
mutate(
relig = fct_lump(gss_cat$relig, n = 5)
) |>
ggplot(aes(y = relig)) +
geom_bar()
gss_cat |>
mutate(
relig = fct_lump(gss_cat$relig, n = 5)
) |>
group_by(relig) |>
count()
gss_cat |>
mutate(
relig = fct_lump(gss_cat$relig, n = 5)
) |>
group_by(relig) |>
count() |>
ggplot(aes(y = reorder(relig, -n), x = n)) +
geom_bar()
gss_cat |>
mutate(
relig = fct_lump(gss_cat$relig, n = 5)
) |>
group_by(relig) |>
count() |>
ggplot(aes(y = reorder(relig, -n), x = n)) +
geom_bar(stat = "identity")
```{r}
gss_cat |>
mutate(
relig = fct_lump(gss_cat$relig, n = 5)
) |>
group_by(relig) |>
count() |>
ggplot(aes(y = reorder(relig, n), x = n)) +
geom_bar(stat = "identity") +
theme_minimal()
?fct_lump
gss_cat |>
mutate(
relig = fct_lump_lowfreq(gss_cat$relig)
) |>
group_by(relig) |>
count() |>
ggplot(aes(y = reorder(relig, n), x = n)) +
geom_bar(stat = "identity") +
theme_minimal()
gss_cat |>
mutate(
relig = fct_lump_min(gss_cat$relig, min = 1000)
) |>
group_by(relig) |>
count() |>
ggplot(aes(y = reorder(relig, n), x = n)) +
geom_bar(stat = "identity") +
theme_minimal()
gss_cat
gss_ca
gss_cat
#| label: setup
library(tidyverse)
library(ggthemes)
library(gt)
data("gss_cat")
## Question 2
**For each factor in `gss_cat` identify whether the order of the levels is arbitrary or principled.**
## Question 2
**For each factor in `gss_cat` identify whether the order of the levels is arbitrary or principled.**
## Question 2
**For each factor in `gss_cat` identify whether the order of the levels is arbitrary or principled.**
## Question 2
**For each factor in `gss_cat` identify whether the order of the levels is arbitrary or principled.**
#| label: setup
library(tidyverse)
library(ggthemes)
library(gt)
data("gss_cat")
gss_cat |>
print(n = 5)
levels(gss_cat$partyid)
fct_collapse(
"Republican"  = c("Strong republican",  "Not str republican"),
"Democrat"    = c("Strong democrat", "Not str democrat"),
"Independent" = c("Independent", "Ind,near dem", "Ind,near rep")
)
gss_cat |>
mutate(
partyid = fct_collapse(partyid,
"Republican"  = c("Strong republican",  "Not str republican"),
"Democrat"    = c("Strong democrat", "Not str democrat"),
"Independent" = c("Independent", "Ind,near dem", "Ind,near rep")
)
)
gss_cat |>
mutate(
partyid = fct_collapse(partyid,
"Republican"  = c("Strong republican",  "Not str republican"),
"Democrat"    = c("Strong democrat", "Not str democrat"),
"Independent" = c("Independent", "Ind,near dem", "Ind,near rep")
)
) |>
group_by(partyid) |>
count()
gss_cat |>
mutate(
partyid = fct_collapse(partyid,
"Republican"  = c("Strong republican",  "Not str republican"),
"Democrat"    = c("Strong democrat", "Not str democrat"),
"Independent" = c("Independent", "Ind,near dem", "Ind,near rep"),
"Others"      = c("No answer", "Don't know", "Other party")
)
) |>
group_by(partyid) |>
count()
gss_cat |>
mutate(
partyid = fct_collapse(partyid,
"Republican"  = c("Strong republican",  "Not str republican"),
"Democrat"    = c("Strong democrat", "Not str democrat"),
"Independent" = c("Independent", "Ind,near dem", "Ind,near rep"),
"Others"      = c("No answer", "Don't know", "Other party")
)
) |>
group_by(year, partyid) |>
count()
gss_cat |>
mutate(
partyid = fct_collapse(partyid,
"Republican"  = c("Strong republican",  "Not str republican"),
"Democrat"    = c("Strong democrat", "Not str democrat"),
"Independent" = c("Independent", "Ind,near dem", "Ind,near rep"),
"Others"      = c("No answer", "Don't know", "Other party")
)
) |>
group_by(year, partyid) |>
count() |>
ggplot(aes(x = year, y = n, fill = prop)) +
geom_bar(stat = "identity")
gss_cat |>
mutate(
partyid = fct_collapse(partyid,
"Republican"  = c("Strong republican",  "Not str republican"),
"Democrat"    = c("Strong democrat", "Not str democrat"),
"Independent" = c("Independent", "Ind,near dem", "Ind,near rep"),
"Others"      = c("No answer", "Don't know", "Other party")
)
) |>
group_by(year, partyid) |>
count() |>
ggplot(aes(x = year, y = n, fill = partyid)) +
geom_bar(stat = "identity")
?geom_bar
gss_cat |>
mutate(
partyid = fct_collapse(partyid,
"Republican"  = c("Strong republican",  "Not str republican"),
"Democrat"    = c("Strong democrat", "Not str democrat"),
"Independent" = c("Independent", "Ind,near dem", "Ind,near rep"),
"Others"      = c("No answer", "Don't know", "Other party")
)
) |>
group_by(year, partyid) |>
count() |>
ggplot(aes(x = year, y = n, fill = partyid)) +
geom_col(stat = "identity")
gss_cat |>
mutate(
partyid = fct_collapse(partyid,
"Republican"  = c("Strong republican",  "Not str republican"),
"Democrat"    = c("Strong democrat", "Not str democrat"),
"Independent" = c("Independent", "Ind,near dem", "Ind,near rep"),
"Others"      = c("No answer", "Don't know", "Other party")
)
) |>
group_by(year, partyid) |>
count() |>
ggplot(aes(x = year, y = n, fill = partyid)) +
geom_col(position = "fill")
gss_cat |>
mutate(
partyid = fct_collapse(partyid,
"Republican"  = c("Strong republican",  "Not str republican"),
"Democrat"    = c("Strong democrat", "Not str democrat"),
"Independent" = c("Independent", "Ind,near dem", "Ind,near rep"),
"Others"      = c("No answer", "Don't know", "Other party")
)
) |>
group_by(year, partyid) |>
count() |>
ggplot(aes(x = year, y = n, fill = partyid)) +
geom_col(position = "fill") +
theme(legend.position = "bottom") +
scale_fill_manual(vales = c("grey", "red", "purple", "blue"))
gss_cat |>
mutate(
partyid = fct_collapse(partyid,
"Republican"  = c("Strong republican",  "Not str republican"),
"Democrat"    = c("Strong democrat", "Not str democrat"),
"Independent" = c("Independent", "Ind,near dem", "Ind,near rep"),
"Others"      = c("No answer", "Don't know", "Other party")
)
) |>
group_by(year, partyid) |>
count() |>
ggplot(aes(x = year, y = n, fill = partyid)) +
geom_col(position = "fill") +
theme(legend.position = "bottom") +
scale_fill_manual(values = c("grey", "red", "purple", "blue"))
gss_cat |>
mutate(
partyid = fct_collapse(partyid,
"Republican"  = c("Strong republican",  "Not str republican"),
"Democrat"    = c("Strong democrat", "Not str democrat"),
"Independent" = c("Independent", "Ind,near dem", "Ind,near rep"),
"Others"      = c("No answer", "Don't know", "Other party")
)
) |>
group_by(year, partyid) |>
count() |>
ggplot(aes(x = year, y = n, fill = partyid)) +
geom_col(position = "fill") +
theme(legend.position = "bottom") +
scale_fill_manual(values = c("lightgrey", "red", "grey", "blue"))
gss_cat |>
mutate(
partyid = fct_collapse(partyid,
"Republican"  = c("Strong republican",  "Not str republican"),
"Democrat"    = c("Strong democrat", "Not str democrat"),
"Independent" = c("Independent", "Ind,near dem", "Ind,near rep"),
"Others"      = c("No answer", "Don't know", "Other party")
)
) |>
group_by(year, partyid) |>
count() |>
ggplot(aes(x = year, y = n, fill = partyid)) +
geom_col(position = "fill") +
theme(legend.position = "bottom") +
scale_fill_manual(values = c("lightgrey", "red", "grey", "blue")) +
theme_classic()
gss_cat |>
mutate(
partyid = fct_collapse(partyid,
"Republican"  = c("Strong republican",  "Not str republican"),
"Democrat"    = c("Strong democrat", "Not str democrat"),
"Independent" = c("Independent", "Ind,near dem", "Ind,near rep"),
"Others"      = c("No answer", "Don't know", "Other party")
)
) |>
group_by(year, partyid) |>
count() |>
ggplot(aes(x = year, y = n, fill = partyid)) +
geom_col(position = "fill") +
scale_fill_manual(values = c("lightgrey", "red", "grey", "blue")) +
theme_classic() +
theme(legend.position = "bottom")
gss_cat |>
mutate(
partyid = fct_collapse(partyid,
"Republican"  = c("Strong republican",  "Not str republican"),
"Democrat"    = c("Strong democrat", "Not str democrat"),
"Independent" = c("Independent", "Ind,near dem", "Ind,near rep"),
"Others"      = c("No answer", "Don't know", "Other party")
)
) |>
group_by(year, partyid) |>
count() |>
ggplot(aes(x = year, y = n, fill = partyid)) +
geom_col(position = "fill") +
scale_fill_manual(values = c("lightgrey", "red", "grey", "blue")) +
theme_classic() +
theme(legend.position = "bottom") +
labs(x = "Year", y = "Proportion of respondents", fill = "Party")
gss_cat |>
mutate(
partyid = fct_collapse(partyid,
"Republican"  = c("Strong republican",  "Not str republican"),
"Democrat"    = c("Strong democrat", "Not str democrat"),
"Independent" = c("Independent", "Ind,near dem", "Ind,near rep"),
"Others"      = c("No answer", "Don't know", "Other party")
)
) |>
group_by(year, partyid) |>
count() |>
ggplot(aes(x = year, y = n, fill = partyid)) +
geom_col(position = "fill") +
scale_fill_manual(values = c("lightgrey", "red", "grey", "blue")) +
theme_classic() +
theme(legend.position = "bottom") +
labs(x = "Year", y = "Proportion of respondents", fill = "Party",
subtitle = "Proportion of republicans has decreased, while that of independents has increased over the years",
title = "In 15 years, share of parties' supporters has changed")
gss_cat|>
mutate(
rincome = fct_lump_lowfreq(rincome)
) |>
group_by(rincome) |>
count()
gss_cat|>
group_by(rincome) |>
count()
?fct_lump
gss_cat|>
mutate(
rincome = fct_lump_n(rincome, n = 10)
) |>
group_by(rincome) |>
count()
gss_cat|>
mutate(
rincome = fct_lump_min(rincome, min = 1000)
) |>
group_by(rincome) |>
count()
gss_cat|>
mutate(
rincome = fct_lump_prop(rincome, prop = 0.2)
) |>
group_by(rincome) |>
count()
gss_cat|>
mutate(
rincome = fct_lump_prop(rincome, prop = 0.1)
) |>
group_by(rincome) |>
count()
gss_cat|>
mutate(
rincome = fct_lump_prop(rincome, prop = 0.01)
) |>
group_by(rincome) |>
count()
gss_cat|>
mutate(
rincome = fct_lump_n(rincome, n = 6)
) |>
group_by(rincome) |>
count()
gss_cat|>
mutate(
rincome = fct_lump_n(rincome, n = 6)
) |>
group_by(rincome) |>
count() |>
gt() |>
cols_label("Annual Income" = rincome,
"Numbers" = n)
?cols_label
gss_cat|>
mutate(
rincome = fct_lump_n(rincome, n = 6)
) |>
group_by(rincome) |>
count() |>
gt() |>
cols_label(rincome = "Annual Income",
n = "Numbers")
gss_cat|>
mutate(
rincome = fct_lump_n(rincome, n = 6)
) |>
group_by(rincome) |>
count() |>
ungroup() |>
gt() |>
cols_label(rincome = "Annual Income",
n = "Numbers")
gss_cat|>
mutate(
rincome = fct_lump_n(rincome, n = 6)
) |>
group_by(rincome) |>
count() |>
arrange(desc(n)) |>
ungroup() |>
gt() |>
cols_label(rincome = "Annual Income",
n = "Numbers")
?fct_lump
gss_cat |>
mutate(relig = fct_lump_n(relig, n = 10)) |>
count(relig, sort = TRUE)
gss_cat |>
mutate(relig = fct_lump_n(relig, n = 10)) |>
count(relig)
gss_cat |>
mutate(relig = fct_lump_n(relig, n = 10)) |>
count(relig) |>
gt()
