scale_x_continuous(breaks = seq(1880, 2000, 20)) +
geom_rect(mapping = aes(xmin = 1890, xmax = 1920,
ymin = y_coord[1], ymax = y_coord[2]),
alpha = 0.1, fill = "grey")
df4 |>
group_by(year) |>
count(name_length, wt = n) |>
summarise(mean_length = weighted.mean(name_length, w = n)) |>
ggplot(aes(x = year, y = mean_length)) +
geom_line() +
theme_classic() +
labs(y = "Average name length (for each year)",
x = "Year") +
scale_x_continuous(breaks = seq(1880, 2000, 20)) +
geom_rect(mapping = aes(xmin = 1890, xmax = 1920,
ymin = y_coord[1], ymax = y_coord[2]),
alpha = 0.1, fill = "grey") +
coord_cartesian(ylim = y_coord)
y_coord = c(5.4, 6.3)
df4 |>
group_by(year) |>
count(name_length, wt = n) |>
summarise(mean_length = weighted.mean(name_length, w = n)) |>
ggplot(aes(x = year, y = mean_length)) +
geom_line() +
theme_classic() +
labs(y = "Average name length (for each year)",
x = "Year") +
scale_x_continuous(breaks = seq(1880, 2000, 20)) +
geom_rect(mapping = aes(xmin = 1890, xmax = 1920,
ymin = y_coord[1], ymax = y_coord[2]),
alpha = 0.1, fill = "grey") +
coord_cartesian(ylim = y_coord)
?annotate
df4 |>
group_by(year) |>
count(name_length, wt = n) |>
summarise(mean_length = weighted.mean(name_length, w = n)) |>
ggplot(aes(x = year, y = mean_length)) +
geom_line() +
theme_classic() +
labs(y = "Average name length (for each year)",
x = "Year") +
scale_x_continuous(breaks = seq(1880, 2000, 20)) +
geom_rect(mapping = aes(xmin = 1890, xmax = 1920,
ymin = y_coord[1], ymax = y_coord[2]),
alpha = 0.01, fill = "grey") +
coord_cartesian(ylim = y_coord)
df4 |>
group_by(year) |>
count(name_length, wt = n) |>
summarise(mean_length = weighted.mean(name_length, w = n)) |>
ggplot(aes(x = year, y = mean_length)) +
theme_classic() +
labs(y = "Average name length (for each year)",
x = "Year") +
scale_x_continuous(breaks = seq(1880, 2000, 20)) +
geom_rect(mapping = aes(xmin = 1890, xmax = 1920,
ymin = y_coord[1], ymax = y_coord[2]),
alpha = 0.01, fill = "grey") +
geom_rect(mapping = aes(xmin = 1960, xmax = 1990,
ymin = y_coord[1], ymax = y_coord[2]),
alpha = 0.01, fill = "grey") +
geom_line() +
coord_cartesian(ylim = y_coord)
df4 |>
group_by(year) |>
count(name_length, wt = n) |>
summarise(mean_length = weighted.mean(name_length, w = n)) |>
ggplot(aes(x = year, y = mean_length)) +
theme_classic() +
labs(y = "Average name length (for each year)",
x = "Year",
title = "Baby names have become longer over the past 12 decades",
subtitle = "Between 1890-1920, and 1960-1990 baby names became longer\nBut, since 1990 the names are becoming shorter again") +
scale_x_continuous(breaks = seq(1880, 2000, 20)) +
geom_rect(mapping = aes(xmin = 1890, xmax = 1920,
ymin = y_coord[1], ymax = y_coord[2]),
alpha = 0.01, fill = "grey") +
geom_rect(mapping = aes(xmin = 1960, xmax = 1990,
ymin = y_coord[1], ymax = y_coord[2]),
alpha = 0.01, fill = "grey") +
geom_line(lwd = 1) +
coord_cartesian(ylim = y_coord)
df4 |>
group_by(year) |>
count(name_length, wt = n) |>
summarise(mean_length = weighted.mean(name_length, w = n)) |>
ggplot(aes(x = year, y = mean_length)) +
theme_classic() +
labs(y = "Average name length (for each year)",
x = "Year",
title = "Baby names have become longer over the past 12 decades",
subtitle = "Between 1890-1920, and 1960-1990 baby names became longer\nBut, since 1990 the names are becoming shorter again") +
scale_x_continuous(breaks = seq(1880, 2000, 20)) +
geom_rect(mapping = aes(xmin = 1890, xmax = 1920,
ymin = y_coord[1], ymax = y_coord[2]),
alpha = 0.01, fill = "grey") +
geom_rect(mapping = aes(xmin = 1960, xmax = 1990,
ymin = y_coord[1], ymax = y_coord[2]),
alpha = 0.01, fill = "grey") +
geom_line(lwd = 1) +
coord_cartesian(ylim = y_coord) +
theme(plot.title.position = "plot")
df4
df4 |>
group_by(year) |>
count(name_start, wt = n)
df4 |>
group_by(year) |>
count(name_start, wt = n) |>
ggplot(aes(x = year, y = n, col = name_start)) +
geom_line()
df4 |>
group_by(year) |>
count(name_start, wt = n)
df4 |>
group_by(year) |>
count(name_start, wt = n) |>
mutate(prop = n/sum(n))
df4 |>
group_by(year) |>
count(name_start, wt = n) |>
mutate(prop = n/sum(n)) |>
ggplot(aes(x = year, y = prop, col = name_start)) +
geom_line()
df4 |>
group_by(year) |>
count(name_start, wt = n) |>
mutate(prop = n/sum(n)) |>
ggplot(aes(x = year, y = prop,
col = name_start, label = name_start)) +
geom_line() +
ggrepel::geom_text_repel()
#| label: fig-q3b-ex5
#| fig-cap: "Starting charcter of babynames over time"
#| code-fold: true
df4
#| label: fig-q3b-ex5
#| fig-cap: "Starting charcter of babynames over time"
#| code-fold: true
df4 |>
count(name_start, wt = n, sort = TRUE)
#| label: fig-q3b-ex5
#| fig-cap: "Starting charcter of babynames over time"
#| code-fold: true
ns_vec = df4 |>
count(name_start, wt = n, sort = TRUE) |>
slice_head(n = 10) |>
select(name_start) |>
as_vector() |>
unname()
df4 |>
filter(name_start %in% ns_vec) |>
group_by(year) |>
count(name_start, wt = n) |>
mutate(prop = n/sum(n)) |>
ggplot(aes(x = year, y = prop,
col = name_start, label = name_start)) +
geom_line() +
ggrepel::geom_text_repel()
#| label: fig-q3b-ex5
#| fig-cap: "Starting charcter of babynames over time"
#| code-fold: true
ns_vec = df4 |>
count(name_start, wt = n, sort = TRUE) |>
slice_head(n = 5) |>
select(name_start) |>
as_vector() |>
unname()
df4 |>
filter(name_start %in% ns_vec) |>
group_by(year) |>
count(name_start, wt = n) |>
mutate(prop = n/sum(n)) |>
ggplot(aes(x = year, y = prop,
col = name_start, label = name_start)) +
geom_line() +
ggrepel::geom_text_repel()
df4 |>
filter(name_start %in% ns_vec) |>
group_by(year) |>
count(name_start, wt = n) |>
mutate(prop = n/sum(n)) |>
mutate(lbl = if_else(Year == max(Year),
name_start,
NA_character_)) |>
ggplot(aes(x = year, y = prop,
col = name_start, label = lbl)) +
geom_line() +
ggrepel::geom_label_repel(nudge_x = 1)
df4 |>
filter(name_start %in% ns_vec) |>
group_by(year) |>
count(name_start, wt = n) |>
mutate(prop = n/sum(n)) |>
mutate(lbl = if_else(year == max(year),
name_start,
NA_character_)) |>
ggplot(aes(x = year, y = prop,
col = name_start, label = lbl)) +
geom_line() +
ggrepel::geom_label_repel(nudge_x = 1)
df4 |>
filter(name_start %in% ns_vec) |>
group_by(year) |>
count(name_start, wt = n) |>
mutate(prop = n/sum(n)) |>
mutate(lbl = if_else(year == max(year),
name_start,
NA_character_))
df4 |>
filter(name_start %in% ns_vec) |>
group_by(year) |>
count(name_start, wt = n) |>
mutate(prop = n/sum(n)) |>
mutate(lbl = if_else(year == max(year),
name_start,
NA))
df4 |>
filter(name_start %in% ns_vec) |>
group_by(year) |>
count(name_start, wt = n) |>
mutate(prop = n/sum(n))
df4 |>
filter(name_start %in% ns_vec) |>
group_by(year) |>
count(name_start, wt = n) |>
mutate(prop = n/sum(n)) |>
mutate(lbl = if_else(year == max(year),
name_start,
NA)) |>
ggplot(aes(x = year, y = prop,
col = name_start, label = lbl)) +
geom_line() +
ggrepel::geom_label_repel(nudge_x = 1)
max(df4$year)
df4 |>
filter(name_start %in% ns_vec) |>
group_by(year) |>
count(name_start, wt = n) |>
mutate(prop = n/sum(n)) |>
mutate(lbl = if_else(year == 2017,
name_start,
NA)) |>
ggplot(aes(x = year, y = prop,
col = name_start, label = lbl)) +
geom_line() +
ggrepel::geom_label_repel(nudge_x = 1)
df4 |>
filter(name_start %in% ns_vec) |>
group_by(year) |>
count(name_start, wt = n) |>
mutate(prop = 100*n/sum(n)) |>
mutate(lbl = if_else(year == 2017,
name_start,
NA)) |>
ggplot(aes(x = year, y = prop,
col = name_start, label = lbl)) +
geom_line() +
ggrepel::geom_label_repel(nudge_x = 1) +
labs(x = "Year",
y = "Percentage of names starting with character")
df4 |>
filter(name_start %in% ns_vec) |>
group_by(year) |>
count(name_start, wt = n) |>
mutate(prop = 100*n/sum(n)) |>
mutate(lbl = if_else(year == 2017,
name_start,
NA)) |>
ggplot(aes(x = year, y = prop,
col = name_start, label = lbl)) +
geom_line(lwd = 1) +
ggrepel::geom_label_repel(nudge_x = 1) +
labs(x = "Year",
y = "Percentage of names starting with character") +
theme_classic()
df4 |>
filter(name_start %in% ns_vec) |>
group_by(year) |>
count(name_start, wt = n) |>
mutate(prop = 100*n/sum(n)) |>
mutate(lbl = if_else(year == 2017,
name_start,
NA)) |>
ggplot(aes(x = year, y = prop,
col = name_start, label = lbl)) +
geom_line(lwd = 1) +
ggrepel::geom_label_repel(nudge_x = 1) +
labs(x = "Year",
y = "Percentage of names starting with character",
title = "People's preferences for baby names' starting letter change over time",
subtitle = "Names starting with A are most popular now\nIn 1950s, names starting with D were really popular, while A wasn't popular") +
theme_classic() +
theme(legend.position = NULL)
df4 |>
filter(name_start %in% ns_vec) |>
group_by(year) |>
count(name_start, wt = n) |>
mutate(prop = 100*n/sum(n)) |>
mutate(lbl = if_else(year == 2017,
name_start,
NA)) |>
ggplot(aes(x = year, y = prop,
col = name_start, label = lbl)) +
geom_line(lwd = 1) +
ggrepel::geom_label_repel(nudge_x = 1) +
labs(x = "Year",
y = "Percentage of names starting with character",
title = "People's preferences for baby names' starting letter change over time",
subtitle = "Names starting with A are most popular now\nIn 1950s, names starting with D were really popular, while A wasn't popular") +
theme_classic() +
theme(legend.position = "none",
plot.title.position = "plot")
df4 |>
filter(name_start %in% ns_vec) |>
group_by(year) |>
count(name_start, wt = n) |>
mutate(prop = 100*n/sum(n)) |>
mutate(lbl = if_else(year == 2017,
name_start,
NA)) |>
ggplot(aes(x = year, y = prop,
col = name_start, label = lbl)) +
geom_line(lwd = 1) +
ggrepel::geom_label_repel(nudge_x = 1) +
labs(x = "Year",
y = "Percentage of names starting with character",
title = "People's preferences for baby names' starting letter change over time",
subtitle = "Names starting with A are most popular now\nIn 1950s, names starting with D were really popular, while A wasn't popular") +
theme_classic() +
theme(legend.position = "none",
plot.title.position = "plot") +
scale_x_continuous(breaks = seq(1880, 2020, 20))
df4 |>
filter(name_start %in% ns_vec) |>
group_by(year) |>
count(name_start, wt = n) |>
mutate(prop = 100*n/sum(n)) |>
mutate(lbl = if_else(year == 2017,
name_start,
NA)) |>
ggplot(aes(x = year, y = prop,
col = name_start, label = lbl)) +
geom_line(lwd = 1) +
ggrepel::geom_label_repel(nudge_x = 1) +
labs(x = "Year",
y = "Percentage of names starting with character",
title = "People's preferences for baby names' starting letter change over time",
subtitle = "Names starting with A are most popular now\nNames starting with J were popular in the 1940s\nIn 1950s, names starting with D were really popular, while A wasn't popular") +
theme_classic() +
theme(legend.position = "none",
plot.title.position = "plot") +
scale_x_continuous(breaks = seq(1880, 2020, 20))
df4 |>
filter(name_start %in% ns_vec) |>
group_by(year) |>
count(name_start, wt = n) |>
mutate(prop = 100*n/sum(n)) |>
mutate(lbl = if_else(year == 2017,
name_start,
NA)) |>
ggplot(aes(x = year, y = prop,
col = name_start, label = lbl)) +
geom_line(lwd = 1) +
ggrepel::geom_label_repel(nudge_x = 1) +
labs(x = "Year",
y = "Percentage of names starting with character",
title = "People's preferences for baby names' starting letter change over time",
subtitle = "Names starting with A are most popular now\nNames starting with J were popular in the 1940s\nIn 1950s, names starting with D became popular, while those starting with A lost popularity") +
theme_classic() +
theme(legend.position = "none",
plot.title.position = "plot") +
scale_x_continuous(breaks = seq(1880, 2020, 20))
df4 |>
filter(name_start %in% ns_vec) |>
group_by(year) |>
count(name_start, wt = n) |>
mutate(prop = 100*n/sum(n)) |>
mutate(lbl = if_else(year == 2017,
name_start,
NA))
df4 |>
filter(name_start %in% ns_vec) |>
group_by(year) |>
count(name_start, wt = n) |>
mutate(prop = 100*n/sum(n)) |>
mutate(lbl = if_else(year == max(year),
name_start,
NA))
df4 |>
filter(name_start %in% ns_vec) |>
group_by(year) |>
count(name_start, wt = n) |>
mutate(prop = 100*n/sum(n)) |>
mutate(lbl = if_else(year == max(year, na.rm = TRUE),
name_start,
NA))
max(df4$year)
df4 |>
filter(name_start %in% ns_vec) |>
group_by(year) |>
count(name_start, wt = n) |>
mutate(prop = 100*n/sum(n)) |>
mutate(lbl = if_else(year == 2017,
name_start,
NA)) |>
ggplot(aes(x = year, y = prop,
col = name_start, label = lbl)) +
geom_line(lwd = 1) +
ggrepel::geom_label_repel(nudge_x = 1) +
labs(x = "Year",
y = "Percentage of names starting with character",
title = "People's preferences for baby names' starting letter change over time",
subtitle = "Names starting with A are most popular now\nNames starting with J were popular in the 1940s\nIn 1950s, names starting with D became popular, while those starting with A lost popularity") +
theme_classic() +
theme(legend.position = "none",
plot.title.position = "plot") +
scale_x_continuous(breaks = seq(1880, 2020, 20))
df4 |>
filter(name_start %in% ns_vec) |>
group_by(year) |>
count(name_start, wt = n) |>
mutate(prop = 100*n/sum(n)) |>
mutate(lbl = if_else(year == 2017,
name_start,
NA)) |>
ggplot(aes(x = year, y = prop,
col = name_start, label = lbl)) +
geom_line(lwd = 1) +
ggrepel::geom_label_repel(nudge_x = 1) +
labs(x = "Year",
y = "Percentage of names starting with character",
title = "People's preferences for baby names' starting letter change over time",
subtitle = "Names starting with A are most popular now\nNames starting with J were popular in the 1940s\nIn 1950s, names starting with D became popular, while those starting with A lost popularity") +
theme_classic() +
theme(legend.position = "none",
plot.title.position = "plot") +
scale_x_continuous(breaks = seq(1880, 2020, 20))
ns_vec = df4 |>
count(name_start, wt = n, sort = TRUE) |>
slice_head(n = 5) |>
select(name_start) |>
as_vector() |>
unname()
df4 |>
filter(name_end %in% ns_vec) |>
group_by(year) |>
count(name_end, wt = n) |>
mutate(prop = 100*n/sum(n)) |>
mutate(lbl = if_else(year == 2017,
name_end,
NA)) |>
ggplot(aes(x = year, y = prop,
col = name_end, label = lbl)) +
geom_line(lwd = 1) +
ggrepel::geom_label_repel(nudge_x = 1) +
labs(x = "Year",
y = "Percentage of names ending with character",
title = "People's preferences for baby names' ending letter change over time",
subtitle = "") +
theme_classic() +
theme(legend.position = "none",
plot.title.position = "plot") +
scale_x_continuous(breaks = seq(1880, 2020, 20))
ns_vec = df4 |>
count(name_end, wt = n, sort = TRUE) |>
slice_head(n = 5) |>
select(name_end) |>
as_vector() |>
unname()
df4 |>
filter(name_end %in% ns_vec) |>
group_by(year) |>
count(name_end, wt = n) |>
mutate(prop = 100*n/sum(n)) |>
mutate(lbl = if_else(year == 2017,
name_end,
NA)) |>
ggplot(aes(x = year, y = prop,
col = name_end, label = lbl)) +
geom_line(lwd = 1) +
ggrepel::geom_label_repel(nudge_x = 1) +
labs(x = "Year",
y = "Percentage of names ending with character",
title = "People's preferences for baby names' ending letter change over time",
subtitle = "") +
theme_classic() +
theme(legend.position = "none",
plot.title.position = "plot") +
scale_x_continuous(breaks = seq(1880, 2020, 20))
df4 |>
filter(name_end %in% ns_vec) |>
group_by(year) |>
count(name_end, wt = n) |>
mutate(prop = 100*n/sum(n)) |>
mutate(lbl = if_else(year == 2017,
name_end,
NA)) |>
ggplot(aes(x = year, y = prop,
col = name_end, label = lbl)) +
geom_line(lwd = 1) +
ggrepel::geom_label_repel(nudge_x = 1) +
labs(x = "Year",
y = "Percentage of names ending with character",
title = "People's preferences for baby names' ending letter change over time",
subtitle = "Names ending in N have risen in popularity over the decades.\nNames ending with E have become less popular over time") +
theme_classic() +
theme(legend.position = "none",
plot.title.position = "plot") +
scale_x_continuous(breaks = seq(1880, 2020, 20))
