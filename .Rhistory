title = "...") +
theme(axis.ticks.y = element_blank(),
axis.title.y = element_blank(),
legend.position = "blank",
panel.grid = element_blank())
df1 |>
filter(manufacturer %in% top_m) |>
group_by(manufacturer) |>
summarize(
nos = n(),
median_delay = mean(median_dep_delay, na.rm = TRUE)
) |>
mutate(is_positive = if_else(median_delay > 0, +1, -1)) |>
ggplot(aes(x = median_delay,
y = reorder(manufacturer, -median_delay),
fill = factor(is_positive),
label = paste0("Flights = ", nos))) +
geom_bar(stat = "identity") +
geom_text(position = "fill") +
theme_minimal() +
scale_x_continuous(breaks = seq(-4, 4, 1)) +
scale_fill_manual(values = c("#119644", "#ed523e")) +
labs(x = "Average of the Median Depature Delays of flights of the manufacturer's aircrafts (in minutes)",
y = NULL,
title = "...") +
theme(axis.ticks.y = element_blank(),
axis.title.y = element_blank(),
legend.position = "blank",
panel.grid = element_blank())
df1 |>
filter(manufacturer %in% top_m) |>
group_by(manufacturer) |>
summarize(
nos = n(),
median_delay = mean(median_dep_delay, na.rm = TRUE)
) |>
mutate(is_positive = if_else(median_delay > 0, +1, -1)) |>
ggplot(aes(x = median_delay,
y = reorder(manufacturer, -median_delay),
fill = factor(is_positive),
label = paste0("Flights = ", nos))) +
geom_bar(stat = "identity") +
geom_text(position = "fill", hjust = 1) +
theme_minimal() +
scale_x_continuous(breaks = seq(-4, 4, 1)) +
scale_fill_manual(values = c("#119644", "#ed523e")) +
labs(x = "Average of the Median Depature Delays of flights of the manufacturer's aircrafts (in minutes)",
y = NULL,
title = "...") +
theme(axis.ticks.y = element_blank(),
axis.title.y = element_blank(),
legend.position = "blank",
panel.grid = element_blank())
df1 |>
filter(manufacturer %in% top_m) |>
group_by(manufacturer) |>
summarize(
nos = n(),
median_delay = mean(median_dep_delay, na.rm = TRUE)
) |>
mutate(is_positive = if_else(median_delay > 0, +1, -1)) |>
ggplot(aes(x = median_delay,
y = reorder(manufacturer, -median_delay),
fill = factor(is_positive),
label = paste0("Flights = ", nos))) +
geom_bar(stat = "identity") +
geom_text(position = "fill", hjust = 1.5) +
theme_minimal() +
scale_x_continuous(breaks = seq(-4, 4, 1)) +
scale_fill_manual(values = c("#119644", "#ed523e")) +
labs(x = "Average of the Median Depature Delays of flights of the manufacturer's aircrafts (in minutes)",
y = NULL,
title = "...") +
theme(axis.ticks.y = element_blank(),
axis.title.y = element_blank(),
legend.position = "blank",
panel.grid = element_blank())
df1 |>
filter(manufacturer %in% top_m) |>
group_by(manufacturer) |>
summarize(
nos = n(),
median_delay = mean(median_dep_delay, na.rm = TRUE)
) |>
mutate(is_positive = if_else(median_delay > 0, +1, -1)) |>
ggplot(aes(x = median_delay,
y = reorder(manufacturer, -median_delay),
fill = factor(is_positive),
label = paste0("Flights = ", nos))) +
geom_bar(stat = "identity") +
geom_text(position = "fill", hjust = 1.2) +
theme_minimal() +
scale_x_continuous(breaks = seq(-4, 4, 1)) +
scale_fill_manual(values = c("#119644", "#ed523e")) +
labs(x = "Average of the Median Depature Delays of flights of the manufacturer's aircrafts (in minutes)",
y = NULL,
title = "...") +
theme(axis.ticks.y = element_blank(),
axis.title.y = element_blank(),
legend.position = "blank",
panel.grid = element_blank())
df1 |>
filter(manufacturer %in% top_m) |>
group_by(manufacturer) |>
summarize(
nos = n(),
median_delay = mean(median_dep_delay, na.rm = TRUE)
) |>
mutate(is_positive = if_else(median_delay > 0, +1, -1)) |>
ggplot(aes(x = median_delay,
y = reorder(manufacturer, -median_delay),
fill = factor(is_positive),
label = paste0("Flights = ", nos))) +
geom_bar(stat = "identity") +
geom_text(position = "fill", hjust = 1.2) +
theme_minimal() +
scale_x_continuous(breaks = seq(-4, 4, 1)) +
scale_fill_manual(values = c("#119644", "#ed523e")) +
labs(x = "Average of the Median Depature Delays of flights of the manufacturer's aircrafts (in minutes)",
y = NULL,
title = "Average Departure Delays vary by the aircrafts' manufacturer") +
theme(axis.ticks.y = element_blank(),
axis.title.y = element_blank(),
legend.position = "blank",
panel.grid = element_blank())
?theme
df1 |>
filter(manufacturer %in% top_m) |>
group_by(manufacturer) |>
summarize(
nos = n(),
median_delay = mean(median_dep_delay, na.rm = TRUE)
) |>
mutate(is_positive = if_else(median_delay > 0, +1, -1)) |>
ggplot(aes(x = median_delay,
y = reorder(manufacturer, -median_delay),
fill = factor(is_positive),
label = paste0("Flights = ", nos))) +
geom_bar(stat = "identity") +
geom_text(position = "fill", hjust = 1.2) +
theme_minimal() +
scale_x_continuous(breaks = seq(-4, 4, 1)) +
scale_fill_manual(values = c("#119644", "#ed523e")) +
labs(x = "Average of the Median Depature Delays of flights of the manufacturer's aircrafts (in minutes)",
y = NULL,
title = "Average Departure Delays vary by the aircrafts' manufacturer") +
theme(axis.ticks.y = element_blank(),
axis.title.y = element_blank(),
legend.position = "blank",
panel.grid = element_blank(),
plot.title.position = "plot")
df1 |>
filter(manufacturer %in% top_m) |>
group_by(manufacturer) |>
summarize(
nos = n(),
median_delay = mean(median_dep_delay, na.rm = TRUE)
) |>
mutate(is_positive = if_else(median_delay > 0, +1, -1)) |>
ggplot(aes(x = median_delay,
y = reorder(manufacturer, -median_delay),
fill = factor(is_positive),
label = paste0("Flights = ", nos))) +
geom_bar(stat = "identity") +
geom_text(position = "fill", hjust = 1.2) +
theme_minimal() +
scale_x_continuous(breaks = seq(-4, 4, 1)) +
scale_fill_manual(values = c("#119644", "#ed523e")) +
labs(x = "Average of the Median Depature Delays of flights of the manufacturer's aircrafts (in minutes)",
y = NULL,
title = "Average Departure Delays vary by the aircrafts' manufacturers: Boeing's airplanes get delayed the most") +
theme(axis.ticks.y = element_blank(),
axis.title.y = element_blank(),
legend.position = "blank",
panel.grid = element_blank(),
plot.title.position = "plot")
#| label: fig-q1a-ex7
#| code-fold: true
top_m = df1 |>
group_by(manufacturer) |>
count() |>
filter(n > 100) |>
select(manufacturer) |>
as_vector() |>
unname()
df1 |>
filter(manufacturer %in% top_m) |>
group_by(manufacturer) |>
summarize(
nos = n(),
median_delay = mean(median_dep_delay, na.rm = TRUE)
) |>
mutate(is_positive = if_else(median_delay > 0, +1, -1)) |>
ggplot(aes(x = median_delay,
y = reorder(manufacturer, -median_delay),
fill = factor(is_positive),
label = paste0("Flights = ", nos))) +
geom_bar(stat = "identity") +
geom_text(position = "fill", hjust = 1.2) +
theme_minimal() +
scale_x_continuous(breaks = seq(-4, 4, 1)) +
scale_fill_manual(values = c("#119644", "#ed523e")) +
labs(x = "Average of the Median Depature Delays of flights of the manufacturer's aircrafts (in minutes)",
y = NULL,
title = "Average Departure Delays vary by the aircrafts' manufacturers: Boeing's airplanes get delayed the most") +
theme(axis.ticks.y = element_blank(),
axis.title.y = element_blank(),
legend.position = "blank",
panel.grid = element_blank(),
plot.title.position = "plot")
flights |>
names()
flights |>
mutate(speed = distance/air_time) |>
group_by(dest) |>
summarise(
nos = n(),
mean_speed = mean(speed, na.rm = TRUE),
var_speed  = var(speed, na.rm = TRUE),
sd_speed   = sd(speed, na.rm = TRUE)
)
flights |>
mutate(speed = 60 * distance/air_time) |>
group_by(dest) |>
summarise(
nos = n(),
mean_speed = mean(speed, na.rm = TRUE),
var_speed  = var(speed, na.rm = TRUE),
sd_speed   = sd(speed, na.rm = TRUE)
)
flights |>
mutate(speed = 60 * distance/air_time) |>
group_by(dest) |>
summarise(
nos = n(),
mean_speed = mean(speed, na.rm = TRUE),
var_speed  = var(speed, na.rm = TRUE),
sd_speed   = sd(speed, na.rm = TRUE)
) |>
arrange(desc(nos))
flights |>
mutate(speed = 60 * distance/air_time) |>
group_by(dest) |>
summarise(
nos = n(),
mean_speed = mean(speed, na.rm = TRUE),
var_speed  = var(speed, na.rm = TRUE),
sd_speed   = sd(speed, na.rm = TRUE)
) |>
arrange(desc(nos)) |>
gt() |>
fmt_number(columns = -nos,
decimals = 2) |>
opt_interactive()
flights |>
mutate(speed = 60 * distance/air_time) |>
group_by(dest) |>
count() |>
filter(n > 5000) |>
select(dest) |>
as_vector() |>
unname()
dest_vec = flights |>
group_by(dest) |>
count() |>
filter(n > 5000) |>
select(dest) |>
as_vector() |>
unname()
flights |>
filter(dest %in% dest_vec) |>
mutate(speed = 60 * distance/air_time) |>
group_by(dest) |>
ggplot(aes(x = dest)) +
geom_boxplot()
flights |>
filter(dest %in% dest_vec) |>
mutate(speed = 60 * distance/air_time) |>
group_by(dest) |>
ggplot(aes(y = dest)) +
geom_boxplot()
flights |>
filter(dest %in% dest_vec) |>
mutate(speed = 60 * distance/air_time) |>
group_by(dest) |>
ggplot(aes(y = dest, x = speed)) +
geom_boxplot()
dest_vec = flights |>
group_by(dest) |>
count() |>
filter(n > 10000) |>
select(dest) |>
as_vector() |>
unname()
flights |>
filter(dest %in% dest_vec) |>
mutate(speed = 60 * distance/air_time) |>
group_by(dest) |>
ggplot(aes(y = dest, x = speed)) +
geom_boxplot()
flights |>
filter(dest %in% dest_vec) |>
mutate(speed = 60 * distance/air_time) |>
group_by(dest) |>
ggplot(aes(y = reorder(dest, -mean(speed, na.rm = TRUE)),
x = speed
)
) +
geom_boxplot()
flights |>
filter(dest %in% dest_vec) |>
mutate(speed = 60 * distance/air_time) |>
group_by(dest) |>
mutate(m_s = mean(speed, na.rm = TRUE)) |>
ggplot(aes(y = reorder(dest, -m_s),
x = speed
)
) +
geom_boxplot()
flights |>
filter(dest %in% dest_vec) |>
mutate(speed = 60 * distance/air_time) |>
group_by(dest) |>
mutate(m_s = mean(speed, na.rm = TRUE)) |>
ggplot(aes(y = reorder(dest, m_s),
x = speed)
) +
geom_boxplot(outlier.alpha = 0.2) +
theme_minimal()
flights |>
filter(dest %in% dest_vec) |>
mutate(speed = 60 * distance/air_time) |>
group_by(dest) |>
mutate(m_s = mean(speed, na.rm = TRUE)) |>
ggplot(aes(y = reorder(dest, m_s),
x = speed)
) +
geom_boxplot(outlier.alpha = 0.2,
varwidth = TRUE) +
theme_minimal()
flights |>
filter(dest %in% dest_vec) |>
mutate(speed = 60 * distance/air_time) |>
group_by(dest) |>
mutate(m_s = mean(speed, na.rm = TRUE)) |>
ggplot(aes(y = reorder(dest, m_s),
x = speed)
) +
geom_boxplot(outlier.alpha = 0.2) +
theme_minimal() +
labs(x = "Air speed in miles per hour",
title = "Farther destinations have higher average air speed by aircrafts")
flights |>
filter(dest %in% dest_vec) |>
mutate(speed = 60 * distance/air_time) |>
group_by(dest) |>
mutate(m_s = mean(speed, na.rm = TRUE)) |>
ggplot(aes(y = reorder(dest, m_s),
x = speed)
) +
geom_boxplot(outlier.alpha = 0.2) +
theme_minimal() +
labs(x = "Air speed in miles per hour",
y = NULL,
title = "Farther destinations have higher average air speed by aircrafts") +
theme(panel.grid.major.y = element_blank())
flights |>
filter(dest %in% dest_vec) |>
mutate(speed = 60 * distance/air_time) |>
group_by(dest) |>
mutate(m_s = mean(speed, na.rm = TRUE)) |>
ggplot(aes(y = reorder(dest, m_s),
x = speed)
) +
geom_boxplot(outlier.alpha = 0.2) +
theme_minimal() +
labs(x = "Air speed in miles per hour",
y = NULL,
title = "Farther destinations have higher average air speed by aircrafts") +
theme(panel.grid.major.x = element_blank())
flights |>
filter(dest %in% dest_vec) |>
mutate(speed = 60 * distance/air_time) |>
group_by(dest) |>
mutate(m_s = mean(speed, na.rm = TRUE)) |>
ggplot(aes(y = reorder(dest, m_s),
x = speed)
) +
geom_boxplot(outlier.alpha = 0.2) +
theme_minimal() +
labs(x = "Air speed in miles per hour",
y = NULL,
title = "Farther destinations have higher average air speed by aircrafts") +
theme(panel.grid.major = element_blank())
flights |>
filter(dest %in% dest_vec) |>
mutate(speed = 60 * distance/air_time) |>
group_by(dest) |>
mutate(m_s = mean(speed, na.rm = TRUE)) |>
ggplot(aes(y = reorder(dest, m_s),
x = speed)
) +
geom_boxplot(outlier.alpha = 0.2) +
theme_minimal() +
labs(x = "Air speed in miles per hour",
y = NULL,
title = "Farther destinations have higher average air speed by aircrafts") +
theme(panel.grid.major = element_blank()) +
scale_x_continuous(breaks = seq(100, 600, 100))
flights |>
filter(dest %in% dest_vec) |>
mutate(speed = 60 * distance/air_time) |>
group_by(dest) |>
mutate(m_s = mean(speed, na.rm = TRUE)) |>
ggplot(aes(y = reorder(dest, m_s),
x = speed)
) +
geom_boxplot(outlier.alpha = 0.2) +
theme_minimal() +
labs(x = "Air speed in miles per hour",
y = NULL,
title = "Farther destinations have higher average air speed by aircrafts") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_x_continuous(breaks = seq(100, 600, 100))
flights |>
filter(dest %in% dest_vec) |>
mutate(speed = 60 * distance/air_time) |>
group_by(dest) |>
mutate(m_s = mean(speed, na.rm = TRUE)) |>
ggplot(aes(y = reorder(dest, m_s),
x = speed)
) +
geom_boxplot(outlier.alpha = 0.2) +
theme_minimal() +
labs(x = "Air speed in miles per hour",
y = NULL,
title = "Farther destinations have higher average air speed by aircrafts") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
scale_x_continuous(breaks = seq(100, 600, 100)) +
coord_cartesian(xlim = c(100, 600))
flights |>
filter(dest %in% dest_vec) |>
mutate(speed = 60 * distance/air_time) |>
group_by(dest) |>
mutate(m_s = mean(speed, na.rm = TRUE)) |>
ggplot(aes(y = reorder(dest, m_s),
x = speed)
) +
geom_boxplot(outlier.alpha = 0.2) +
theme_minimal() +
labs(x = "Air speed in miles per hour",
y = NULL,
title = "Farther destinations have higher average air speed of aircrafts") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title.position = "plot") +
scale_x_continuous(breaks = seq(100, 600, 100)) +
coord_cartesian(xlim = c(100, 600))
flights |>
filter(dest %in% dest_vec) |>
mutate(speed = 60 * distance/air_time) |>
group_by(dest) |>
mutate(m_s = mean(speed, na.rm = TRUE)) |>
ggplot(aes(y = reorder(dest, m_s),
x = speed)
) +
geom_boxplot(outlier.alpha = 0.2) +
theme_minimal() +
labs(x = "Air speed in miles per hour",
y = NULL,
title = "Farther destinations have higher average air speed of aircrafts",
subtitle = "Los Angeles bound aircrafts' average speed is much higher than Boston-bound aircrafts") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title.position = "plot") +
scale_x_continuous(breaks = seq(100, 600, 100)) +
coord_cartesian(xlim = c(100, 600))
flights |>
filter(dest %in% dest_vec) |>
mutate(speed = 60 * distance/air_time) |>
group_by(dest) |>
mutate(m_s = mean(speed, na.rm = TRUE)) |>
ggplot(aes(y = reorder(dest, m_s),
x = speed)
) +
geom_boxplot(outlier.alpha = 0.2) +
theme_minimal() +
labs(x = "Air speed (miles per hour)",
y = NULL,
title = "Farther destinations have higher average air speed of aircrafts",
subtitle = "Los Angeles bound aircrafts' average speed is much higher than Boston-bound aircrafts") +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
plot.title.position = "plot") +
scale_x_continuous(breaks = seq(100, 600, 100)) +
coord_cartesian(xlim = c(100, 600))
flights |>
mutate(speed = 60 * distance/air_time) |>
group_by(dest) |>
summarise(
nos = n(),
mean_speed = mean(speed, na.rm = TRUE),
var_speed  = var(speed, na.rm = TRUE),
sd_speed   = sd(speed, na.rm = TRUE)
) |>
arrange(desc(nos)) |>
gt() |>
fmt_number(columns = -nos,
decimals = 2) |>
opt_interactive()
